package console

import "strings"

// Word returns a dremio-friendly word
func Word(str string) string {
	if ok := reserverWords[strings.ToUpper(str)]; ok {
		return `"` + str + `"`
	}
	return str
}

// JoinWords similar to strings.Join but surrounding reserved words in double quotes
func JoinWords(words []string, deli string) string {
	str := make([]string, len(words))
	for i, w := range words {
		str[i] = Word(w)
	}
	return strings.Join(str, deli)
}

// https://docs.dremio.com/sql-reference/reserved-keywords.html
// ReserverWords Following reserved words can only be used with surrounding double quotes " in Dremio.
var reserverWords map[string]bool

func init() {
	reserverWords = map[string]bool{
		"ABS":      true,
		"ALL":      true,
		"ALLOCATE": true,
		"ALLOW":    true,
		"ALTER":    true,
		"AND":      true,
		"ANY":      true,
		"ARE":      true,
		"ARRAY":    true,

		"ARRAY_MAX_CARDINALITY": true,
		"AS":               true,
		"ASENSITIVE":       true,
		"ASYMMETRIC":       true,
		"AT":               true,
		"ATOMIC":           true,
		"AUTHORIZATION":    true,
		"AVG":              true,
		"BEGIN":            true,
		"BEGIN_FRAME":      true,
		"BEGIN_PARTITION":  true,
		"BETWEEN":          true,
		"BIGINT":           true,
		"BINARY":           true,
		"BIT":              true,
		"BLOB":             true,
		"BOOLEAN":          true,
		"BOTH":             true,
		"BY":               true,
		"CALL":             true,
		"CALLED":           true,
		"CARDINALITY":      true,
		"CASCADED":         true,
		"CASE":             true,
		"CAST":             true,
		"CEIL":             true,
		"CEILING":          true,
		"CHAR":             true,
		"CHAR_LENGTH":      true,
		"CHARACTER":        true,
		"CHARACTER_LENGTH": true,
		"CHECK":            true,
		"CLASSIFIER":       true,
		"CLOB":             true,
		"CLOSE":            true,
		"COALESCE":         true,
		"COLLATE":          true,
		"COLLECT":          true,
		"COLUMN":           true,
		"COMMIT":           true,
		"CONDITION":        true,
		"CONNECT":          true,
		"CONSTRAINT":       true,
		"CONTAINS":         true,
		"CONVERT":          true,
		"CORR":             true,
		"CORRESPONDING":    true,
		"COUNT":            true,
		"COVAR_POP":        true,
		"COVAR_SAMP":       true,
		"CREATE":           true,
		"CROSS":            true,
		"CUBE":             true,
		"CUME_DIST":        true,
		"CURRENT":          true,
		"CURRENT_CATALOG":  true,
		"CURRENT_DATE":     true,

		"CURRENT_DEFAULT_TRANSFORM_GROUP": true,

		"CURRENT_PATH":      true,
		"CURRENT_ROLE":      true,
		"CURRENT_ROW":       true,
		"CURRENT_SCHEMA":    true,
		"CURRENT_TIME":      true,
		"CURRENT_TIMESTAMP": true,

		"CURRENT_TRANSFORM_GROUP_FOR_TYPE": true,

		"CURRENT_USER":      true,
		"CURSOR":            true,
		"CYCLE":             true,
		"DATE":              true,
		"DAY":               true,
		"DEALLOCATE":        true,
		"DEC":               true,
		"DECIMAL":           true,
		"DECLARE":           true,
		"DEFAULT":           true,
		"DEFINE":            true,
		"DELETE":            true,
		"DENSE_RANK":        true,
		"DEREF":             true,
		"DESCRIBE":          true,
		"DETERMINISTIC":     true,
		"DISALLOW":          true,
		"DISCONNECT":        true,
		"DISTINCT":          true,
		"DOUBLE":            true,
		"DROP":              true,
		"DYNAMIC":           true,
		"EACH":              true,
		"ELEMENT":           true,
		"ELSE":              true,
		"EMPTY":             true,
		"END":               true,
		"END-EXEC":          true,
		"END_FRAME":         true,
		"END_PARTITION":     true,
		"EQUALS":            true,
		"ESCAPE":            true,
		"EVERY":             true,
		"EXCEPT":            true,
		"EXEC":              true,
		"EXECUTE":           true,
		"EXISTS":            true,
		"EXP":               true,
		"EXPLAIN":           true,
		"EXTEND":            true,
		"EXTERNAL":          true,
		"EXTRACT":           true,
		"FALSE":             true,
		"FETCH":             true,
		"FILTER":            true,
		"FIRST_VALUE":       true,
		"FLOAT":             true,
		"FLOOR":             true,
		"FOR":               true,
		"FOREIGN":           true,
		"FRAME_ROW":         true,
		"FREE":              true,
		"FROM":              true,
		"FULL":              true,
		"FUNCTION":          true,
		"FUSION":            true,
		"GET":               true,
		"GLOBAL":            true,
		"GRANT":             true,
		"GROUP":             true,
		"GROUPING":          true,
		"GROUPS":            true,
		"HAVING":            true,
		"HOLD":              true,
		"HOUR":              true,
		"IDENTITY":          true,
		"IMPORT":            true,
		"IN":                true,
		"INDICATOR":         true,
		"INITIAL":           true,
		"INNER":             true,
		"INOUT":             true,
		"INSENSITIVE":       true,
		"INSERT":            true,
		"INT":               true,
		"INTEGER":           true,
		"INTERSECT":         true,
		"INTERSECTION":      true,
		"INTERVAL":          true,
		"INTO":              true,
		"IS":                true,
		"JOIN":              true,
		"LAG":               true,
		"LANGUAGE":          true,
		"LARGE":             true,
		"LAST_VALUE":        true,
		"LATERAL":           true,
		"LEAD":              true,
		"LEADING":           true,
		"LEFT":              true,
		"LIKE":              true,
		"LIKE_REGEX":        true,
		"LIMIT":             true,
		"LN":                true,
		"LOCAL":             true,
		"LOCALTIME":         true,
		"LOCALTIMESTAMP":    true,
		"LOWER":             true,
		"MATCH":             true,
		"MATCHES":           true,
		"MATCH_NUMBER":      true,
		"MATCH_RECOGNIZE":   true,
		"MAX":               true,
		"MEASURES":          true,
		"MEMBER":            true,
		"MERGE":             true,
		"METHOD":            true,
		"MIN":               true,
		"MINUTE":            true,
		"MOD":               true,
		"MODIFIES":          true,
		"MODULE":            true,
		"MONTH":             true,
		"MORE":              true,
		"MULTISET":          true,
		"NATIONAL":          true,
		"NATURAL":           true,
		"NCHAR":             true,
		"NCLOB":             true,
		"NEW":               true,
		"NEXT":              true,
		"NO":                true,
		"NONE":              true,
		"NORMALIZE":         true,
		"NOT":               true,
		"NTH_VALUE":         true,
		"NTILE":             true,
		"NULL":              true,
		"NULLIF":            true,
		"NUMERIC":           true,
		"OCCURRENCES_REGEX": true,
		"OCTET_LENGTH":      true,
		"OF":                true,
		"OFFSET":            true,
		"OLD":               true,
		"OMIT":              true,
		"ON":                true,
		"ONE":               true,
		"ONLY":              true,
		"OPEN":              true,
		"OR":                true,
		"ORDER":             true,
		"OUT":               true,
		"OUTER":             true,
		"OVER":              true,
		"OVERLAPS":          true,
		"OVERLAY":           true,
		"PARAMETER":         true,
		"PARTITION":         true,
		"PATTERN":           true,
		"PER":               true,
		"PERCENT":           true,
		"PERCENTILE_CONT":   true,
		"PERCENTILE_DISC":   true,
		"PERCENT_RANK":      true,
		"PERIOD":            true,
		"PERMUTE":           true,
		"PORTION":           true,
		"POSITION":          true,
		"POSITION_REGEX":    true,
		"POWER":             true,
		"PRECEDES":          true,
		"PRECISION":         true,
		"PREPARE":           true,
		"PREV":              true,
		"PRIMARY":           true,
		"PROCEDURE":         true,
		"RANGE":             true,
		"RANK":              true,
		"READS":             true,
		"REAL":              true,
		"RECURSIVE":         true,
		"REF":               true,
		"REFERENCES":        true,
		"REFERENCING":       true,
		"REGR_AVGX":         true,
		"REGR_AVGY":         true,
		"REGR_COUNT":        true,
		"REGR_INTERCEPT":    true,
		"REGR_R2":           true,
		"REGR_SLOPE":        true,
		"REGR_SXX":          true,
		"REGR_SXY":          true,
		"REGR_SYY":          true,
		"RELEASE":           true,
		"RESET":             true,
		"RESULT":            true,
		"RETURN":            true,
		"RETURNS":           true,
		"REVOKE":            true,
		"RIGHT":             true,
		"ROLLBACK":          true,
		"ROLLUP":            true,
		"ROW":               true,
		"ROW_NUMBER":        true,
		"ROWS":              true,
		"RUNNING":           true,
		"SAVEPOINT":         true,
		"SCOPE":             true,
		"SCROLL":            true,
		"SEARCH":            true,
		"SECOND":            true,
		"SEEK":              true,
		"SELECT":            true,
		"SENSITIVE":         true,
		"SESSION_USER":      true,
		"SET":               true,
		"MINUS":             true,
		"SHOW":              true,
		"SIMILAR":           true,
		"SKIP":              true,
		"SMALLINT":          true,
		"SOME":              true,
		"SPECIFIC":          true,
		"SPECIFICTYPE":      true,
		"SQL":               true,
		"SQLEXCEPTION":      true,
		"SQLSTATE":          true,
		"SQLWARNING":        true,
		"SQRT":              true,
		"START":             true,
		"STATIC":            true,
		"STDDEV_POP":        true,
		"STDDEV_SAMP":       true,
		"STREAM":            true,
		"SUBMULTISET":       true,
		"SUBSET":            true,
		"SUBSTRING":         true,
		"SUBSTRING_REGEX":   true,
		"SUCCEEDS":          true,
		"SUM":               true,
		"SYMMETRIC":         true,
		"SYSTEM":            true,
		"SYSTEM_TIME":       true,
		"SYSTEM_USER":       true,
		"TABLE":             true,
		"TABLESAMPLE":       true,
		"THEN":              true,
		"TIME":              true,
		"TIMESTAMP":         true,
		"TIMEZONE_HOUR":     true,
		"TIMEZONE_MINUTE":   true,
		"TINYINT":           true,
		"TO":                true,
		"TRAILING":          true,
		"TRANSLATE":         true,
		"TRANSLATE_REGEX":   true,
		"TRANSLATION":       true,
		"TREAT":             true,
		"TRIGGER":           true,
		"TRIM":              true,
		"TRIM_ARRAY":        true,
		"TRUE":              true,
		"TRUNCATE":          true,
		"UESCAPE":           true,
		"UNION":             true,
		"UNIQUE":            true,
		"UNKNOWN":           true,
		"UNNEST":            true,
		"UPDATE":            true,
		"UPPER":             true,
		"UPSERT":            true,
		"USER":              true,
		"USING":             true,
		"VALUE":             true,
		"VALUES":            true,
		"VALUE_OF":          true,
		"VAR_POP":           true,
		"VAR_SAMP":          true,
		"VARBINARY":         true,
		"VARCHAR":           true,
		"VARYING":           true,
		"VERSIONING":        true,
		"WHEN":              true,
		"WHENEVER":          true,
		"WHERE":             true,
		"WIDTH_BUCKET":      true,
		"WINDOW":            true,
		"WITH":              true,
		"WITHIN":            true,
		"WITHOUT":           true,
		"YEAR":              true}
}
